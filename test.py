from electrum.bitcoin import *

mm = "0100000001ece50eb21455ab45c4ae60cfe7879d2c8167af79a8ccbbee4c5116f82a3d7e3b290000008c493046022100b944968a2cdba60fc45ac72a5d65fd17f95640a94e1b0c481e117149c2c62061022100a9909fc6fd3c1c6d3d620f2feb19b2fa0e9311ea18b2e970d364cf4e36a30daf014104956d4b100f699a009a94af5d879164c1243a7126a99fa9e59ab13ad4e8369fb054f4b7df18b83a5a80735f874dc9ccef87ca294ec3d5247efb32e8e94f3d5a6dffffffff02e070e302000000001976a9149bb582c550f803645e30b95b2301ba1de2ede7a188ac80f0fa02000000001976a914b14d6fd378a59a4fa8b4136702f54461db84cf2188ac00000000"

print Hash( m2.decode('hex'))[::-1].encode('hex')


# for sig..
message  = "0100000001a5511941efa259ebcd64854258dd1cee3953da5b6e00a074691a5e48aa25b716000000001876a91460064dd742e383dbaad42af49c791687e46fc188acffffffff02e7810400000000001976a91443ac08fc28fbaf44df5a46750bdeadecc1fb214688ac00e1f505000000001976a91432177140674c5a450e009e52e94d073dc7773b0c88ac0000000001000000"

message2 = "0100000001a5511941efa259ebcd64854258dd1cee3953da5b6e00a074691a5e48aa25b716000000001876a91460064dd742e383dbaad42af49c791687e46fc188acffffffff0200e1f505000000001976a91432177140674c5a450e009e52e94d073dc7773b0c88acf7a80400000000001976a91443ac08fc28fbaf44df5a46750bdeadecc1fb214688ac0000000001000000"


#             3046022100ce59aea3bfe241940086a658eb6b96e3594abe2a300f80866a08ac51d57fadd0022100d9715bd561fac47f9d620c317bfe4f666ede00bc1f3ea022248ef4296f27485801"
#             304402206b277bd570439d82369d8143188c155286625e71454fe008d69163baae138bcf02202be4692d0cd7db3e655d0e7a026c4cb8f565ae13f255ea260f9bbb8c5f627b1801 <-- worked

signature  = "3046022100ce59aea3bfe241940086a658eb6b96e3594abe2a300f80866a08ac51d57fadd0022100d9715bd561fac47f9d620c317bfe4f666ede00bc1f3ea022248ef4296f274858"
signature2 = "304402206b277bd570439d82369d8143188c155286625e71454fe008d69163baae138bcf02202be4692d0cd7db3e655d0e7a026c4cb8f565ae13f255ea260f9bbb8c5f627b18" 


pubkey = "04e4bab90a2b482a8e459ee4b0ccf16f839b33b2e780af994974e0cca52976b6899f4af21e90e7bc2cc7deb9e1943c63dadbe38f19e79922616864173de4d407b1"

#3056301006072a8648ce3d020106052b8104000a034200040787f545fea20330994b7b03c4ce173604d1c5b06b69fb0e3efa71ccef47a7b9fdcda623b7857749f09813c66baf4bf817512df9184ea61abd8b87a0f77976aa


sig = signature2.decode('hex')
msg = message2.decode('hex')

#order = generator_secp256k1.order()
#r, s = ecdsa.util.sigdecode_der(sig.decode('hex'),order)
#sig = ecdsa.util.sigencode_string(r,s, order)

public_key = ecdsa.VerifyingKey.from_string(pubkey.decode('hex')[1:], curve = SECP256k1 )
h = Hash( msg )
public_key.verify_digest( sig, h, sigdecode = ecdsa.util.sigdecode_der)


